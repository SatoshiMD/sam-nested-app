AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31

Globals:
  Function:
    Timeout: 5

Parameters:
  ENV:
    Type: String
    Default: dev

Resources:
  SampleBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Join [ "", [ "sample-bucket", "-", "dev"] ]
  # SampleRestApi:
  #   Type: AWS::Serverless::Api
  #   Properties:
  #     StageName: dev
  SampleMyLayer:
    Type: AWS::Serverless::Application
    Properties:
      Location: common-layer-sample/template.yaml
      Parameters:
        ENV: !Ref ENV
  SampleMyLambdas:
    Type: AWS::Serverless::Application
    Properties:
      Location: sam-lambda-sample/template.yaml
      Parameters:
        ENV: !Ref ENV
        SamplebucketName: !Ref SampleBucket
        SamplebucketArn: !GetAtt SampleBucket.Arn
        ApiId: !GetAtt SampleRestApi.Arn

Outputs:
  SampleMyLayer:
    Description: "Sample Layer ARN"
    Value: !Ref SampleMyLayer
  SampleMyLambdas:
    Description: "Sample My Lambdas ARN"
    Value: !Ref SampleMyLambdas
